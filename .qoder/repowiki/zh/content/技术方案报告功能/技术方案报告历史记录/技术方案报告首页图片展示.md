# 技术方案报告首页图片展示

<cite>
**Referenced Files in This Document**   
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md)
- [TechReportHistoryView.vue](file://src/views/tech-report/TechReportHistoryView.vue)
- [IMAGE_PREVIEW_FIX.md](file://IMAGE_PREVIEW_FIX.md)
</cite>

## 目录
1. [介绍](#介绍)
2. [核心功能实现](#核心功能实现)
3. [点击放大预览功能](#点击放大预览功能)
4. [悬停蒙层交互效果](#悬停蒙层交互效果)
5. [事件隔离机制](#事件隔离机制)
6. [样式与布局](#样式与布局)
7. [兼容性与测试](#兼容性与测试)

## 介绍
本文档深入讲解技术方案报告历史记录中首页图片的展示功能，重点描述v2.0版本新增的点击放大预览功能、悬停蒙层交互效果以及相关技术实现细节。文档基于TECH_REPORT_IMAGE_UPGRADE_V2.md和IMAGE_PREVIEW_FIX.md等技术文档，结合TechReportHistoryView.vue的实际代码实现，全面解析图片展示功能的设计与实现。

## 核心功能实现

技术方案报告历史记录页面的图片展示功能在v2.0版本进行了重大升级，主要包含图片尺寸调整、点击放大预览、悬停蒙层提示和交互优化等核心功能。

### 图片尺寸调整
v2.0版本将图片尺寸从v1.0的180x135px（桌面端）增大至280x210px，增大了55%，使用户能够更清晰地查看图片内容。移动端尺寸也从100%x200px增大至100%x280px，增大了40%。

### 懒加载与错误处理
系统实现了图片懒加载（lazy loading）功能，只加载可视区域的图片，减少初始页面加载时间。同时提供了加载中和加载失败的占位提示，提升用户体验。

**Section sources**
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md#L0-L64)
- [TechReportHistoryView.vue](file://src/views/tech-report/TechReportHistoryView.vue#L49-L55)

## 点击放大预览功能

v2.0版本新增了点击放大预览功能，利用Element Plus的el-image组件的preview-src-list属性实现全屏预览。

### 实现方式
通过el-image组件的preview-src-list属性，将图片URL作为数组传入，即可实现点击放大预览功能。系统还配置了preview-teleported属性，确保预览层挂载到body元素上，避免被父容器样式影响。

```vue
<el-image
  :src="imageUrl"
  fit="contain"
  :preview-src-list="[imageUrl]"
  preview-teleported
  :z-index="3000"
>
</el-image>
```

### fit属性选型理由
系统选择fit='contain'模式，主要基于以下考虑：
1. **保持原始比例**：不会导致图片变形
2. **完整显示内容**：可以看到图片的所有内容，不会被裁剪
3. **适合文档类图片**：技术报告首页图片通常包含文字，需要完整显示

**Section sources**
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md#L65-L120)
- [TechReportHistoryView.vue](file://src/views/tech-report/TechReportHistoryView.vue#L49-L55)

## 悬停蒙层交互效果

系统实现了精美的悬停蒙层交互效果，提升用户体验。

### 视觉设计
当用户鼠标悬停在图片上时，会显示半透明黑色背景的蒙层，包含ZoomIn放大镜图标和"点击放大"文字提示。同时图片会有轻微的上移和阴影增强效果。

### CSS实现
蒙层通过CSS的绝对定位实现，设置position: absolute并覆盖整个图片区域。使用transition属性实现平滑的过渡效果，opacity从0到1的变化过程持续0.2秒。

```scss
.image-mask {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  transition: opacity 0.2s;
  pointer-events: none;
}
```

### pointer-events:none的使用
关键的pointer-events: none属性确保蒙层不会阻挡点击事件，使点击事件能够穿透蒙层到达el-image组件，从而触发预览功能。

**Section sources**
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md#L121-L157)
- [TechReportHistoryView.vue](file://src/views/tech-report/TechReportHistoryView.vue#L500-L557)

## 事件隔离机制

系统通过@click.stop事件修饰符实现了图片预览与卡片跳转的点击行为隔离。

### 问题与修复
最初在图片容器上使用@click.stop修饰符是为了阻止事件冒泡，但这也阻止了el-image组件接收点击事件，导致预览功能无法工作。通过分析发现，正确的做法是移除@click.stop修饰符，并依赖蒙层的pointer-events: none属性来确保点击事件能够正确传递。

### 事件传播链
```
用户点击图片
↓
点击事件穿透蒙层（pointer-events: none）
↓
el-image组件接收到点击事件
↓
触发全屏预览功能
```

**Section sources**
- [IMAGE_PREVIEW_FIX.md](file://IMAGE_PREVIEW_FIX.md#L0-L48)
- [IMAGE_PREVIEW_FIX.md](file://IMAGE_PREVIEW_FIX.md#L49-L110)

## 样式与布局

### 响应式设计
系统采用了响应式设计，在桌面端（>768px）采用左右布局，左侧为280x210px的图片区域，右侧为内容区域。在移动端（≤768px）自动切换为上下布局，图片区域宽度为100%，高度为280px。

### 动画优化
使用transform: translateY(-2px)实现图片悬停时的上移动画，该属性由GPU加速，确保动画流畅。同时使用box-shadow属性增强阴影效果，提升视觉层次感。

**Section sources**
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md#L158-L217)
- [TechReportHistoryView.vue](file://src/views/tech-report/TechReportHistoryView.vue#L493-L557)

## 兼容性与测试

### 兼容性
该功能在主流浏览器中均能正常工作，包括Chrome、Firefox、Safari和Edge。

### 测试建议
- 验证图片正常显示（280x210px）
- 测试点击图片能否打开预览
- 验证预览支持缩放、旋转操作
- 测试悬停时是否显示蒙层提示
- 验证点击内容区域能否正确跳转
- 测试图片加载失败时的占位显示

**Section sources**
- [TECH_REPORT_IMAGE_UPGRADE_V2.md](file://TECH_REPORT_IMAGE_UPGRADE_V2.md#L304-L368)
- [IMAGE_PREVIEW_FIX.md](file://IMAGE_PREVIEW_FIX.md#L250-L317)